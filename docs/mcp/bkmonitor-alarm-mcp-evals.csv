测试ID,测试项名称,测试场景,输入内容,预期输出
LA-001,基础告警列表查询,查询指定业务最近1小时的告警列表,"用户输入：查询业务7最近1小时的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""start_time"": 动态计算(当前时间-3600),
  ""end_time"": 动态计算(当前时间),
  ""page"": 1,
  ""page_size"": 10
}","1. 正确识别使用 list_alerts 工具
2. bk_biz_id 正确传入 ""7""
3. 时间戳动态计算，不使用固定值
4. 返回包含 id、alert_name、status、severity 等字段的告警列表
5. 返回 overview 统计信息"
LA-002,按状态筛选-未恢复告警,查询所有未恢复状态的告警,"用户输入：查看业务7当前所有未恢复的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""status"": [""ABNORMAL""],
  ""start_time"": 动态计算,
  ""end_time"": 动态计算
}","1. 正确理解""未恢复""对应状态值 ""ABNORMAL""
2. status 参数正确设置为数组格式 [""ABNORMAL""]
3. 返回的告警 status 字段均为 ""ABNORMAL""
4. overview 中显示 ABNORMAL 的告警数量"
LA-003,按状态筛选-已恢复告警,查询已恢复状态的告警,"用户输入：查看业务7已恢复的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""status"": [""RECOVERED""]
}","1. 正确理解""已恢复""对应状态值 ""RECOVERED""
2. 返回的告警 status 字段均为 ""RECOVERED"""
LA-004,按状态筛选-已关闭告警,查询已关闭状态的告警,"用户输入：查看业务7已关闭的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""status"": [""CLOSED""]
}","1. 正确理解""已关闭""对应状态值 ""CLOSED""
2. 返回的告警 status 字段均为 ""CLOSED"""
LA-005,多状态筛选,同时查询多个状态的告警,"用户输入：查看业务7未恢复和已恢复的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""status"": [""ABNORMAL"", ""RECOVERED""]
}","1. status 数组包含多个状态值
2. 返回的告警 status 为 ABNORMAL 或 RECOVERED"
LA-006,全文搜索-关键字查询,使用关键字搜索告警,"用户输入：搜索业务7中包含""CPU""的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""query_string"": ""CPU""
}","1. 正确使用 query_string 参数
2. 返回的告警名称或描述中包含""CPU""关键字"
LA-007,全文搜索-中文关键字,使用中文关键字搜索,"用户输入：搜索业务7中关于内存的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""query_string"": ""内存""
}","1. 支持中文关键字搜索
2. 返回相关告警"
LA-008,conditions高级过滤-包含匹配,使用conditions进行模糊匹配,"用户输入：查询业务7告警名称包含""CPU高""的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""conditions"": [
    {
      ""key"": ""alert_name"",
      ""value"": [""CPU高""],
      ""method"": ""include""
    }
  ]
}","1. 正确构造 conditions 数组
2. key 设置为 ""alert_name""
3. method 设置为 ""include""（包含匹配）
4. 返回告警名称包含""CPU高""的告警"
LA-009,conditions高级过滤-精确匹配,使用conditions进行精确匹配,"用户输入：查询业务7告警级别为1（致命）的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""conditions"": [
    {
      ""key"": ""severity"",
      ""value"": [""1""],
      ""method"": ""eq""
    }
  ]
}","1. method 设置为 ""eq""（精确匹配）
2. 返回的告警 severity 均为 1"
LA-010,conditions高级过滤-不等于,使用neq排除某些告警,"用户输入：查询业务7非致命级别的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""conditions"": [
    {
      ""key"": ""severity"",
      ""value"": [""1""],
      ""method"": ""neq""
    }
  ]
}","1. method 设置为 ""neq""（不等于）
2. 返回的告警 severity 不为 1"
LA-011,conditions高级过滤-不包含,使用exclude排除某些告警,"用户输入：查询业务7告警名称不包含""测试""的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""conditions"": [
    {
      ""key"": ""alert_name"",
      ""value"": [""测试""],
      ""method"": ""exclude""
    }
  ]
}","1. method 设置为 ""exclude""（不包含）
2. 返回的告警名称中不包含""测试"""
LA-012,conditions组合条件-AND逻辑,使用AND连接多个条件,"用户输入：查询业务7告警名称包含""CPU""且级别为1的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""conditions"": [
    {
      ""key"": ""alert_name"",
      ""value"": [""CPU""],
      ""method"": ""include"",
      ""condition"": ""and""
    },
    {
      ""key"": ""severity"",
      ""value"": [""1""],
      ""method"": ""eq""
    }
  ]
}","1. 第一个条件的 condition 设置为 ""and""
2. 返回同时满足两个条件的告警"
LA-013,conditions组合条件-OR逻辑,使用OR连接多个条件,"用户输入：查询业务7告警名称包含""CPU""或""内存""的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""conditions"": [
    {
      ""key"": ""alert_name"",
      ""value"": [""CPU""],
      ""method"": ""include"",
      ""condition"": ""or""
    },
    {
      ""key"": ""alert_name"",
      ""value"": [""内存""],
      ""method"": ""include""
    }
  ]
}","1. 使用 ""or"" 逻辑连接
2. 返回满足任一条件的告警"
LA-014,conditions多值匹配,在单个条件中匹配多个值,"用户输入：查询业务7告警名称包含CPU或内存的告警（简化写法）
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""conditions"": [
    {
      ""key"": ""alert_name"",
      ""value"": [""CPU"", ""内存""],
      ""method"": ""include""
    }
  ]
}","1. value 数组包含多个值
2. 返回告警名称包含""CPU""或""内存""的告警"
LA-015,按负责人筛选,查询特定负责人的告警,"用户输入：查询业务7负责人为admin的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""username"": ""admin""
}","1. 正确使用 username 参数
2. 返回的告警 assignee 包含 ""admin"""
LA-016,按策略名筛选,通过conditions按策略名过滤,"用户输入：查询业务7策略名包含""主机监控""的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""conditions"": [
    {
      ""key"": ""strategy_name"",
      ""value"": [""主机监控""],
      ""method"": ""include""
    }
  ]
}","1. key 设置为 ""strategy_name""
2. 返回相关策略的告警"
LA-017,按IP地址筛选,通过conditions按IP过滤告警,"用户输入：查询业务7 IP为10.0.0.1的主机告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""conditions"": [
    {
      ""key"": ""ip"",
      ""value"": [""10.0.0.1""],
      ""method"": ""eq""
    }
  ]
}","1. key 设置为 ""ip""
2. 返回指定IP的告警"
LA-018,时间范围查询-最近24小时,查询最近24小时的告警,"用户输入：查询业务7最近24小时的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""start_time"": 动态计算(当前时间-86400),
  ""end_time"": 动态计算(当前时间)
}","1. start_time = end_time - 86400（24小时 = 86400秒）
2. 时间戳动态计算
3. 返回时间范围内的告警"
LA-019,时间范围查询-最近7天,查询最近7天的告警,"用户输入：查询业务7最近一周的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""start_time"": 动态计算(当前时间-604800),
  ""end_time"": 动态计算(当前时间)
}","1. start_time = end_time - 604800（7天 = 604800秒）
2. 正确理解""一周""对应7天"
LA-020,排序-按时间倒序,获取最新的告警,"用户输入：查询业务7最新的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""ordering"": [""-create_time""]
}","1. ordering 使用 ""-create_time""（前缀-表示降序）
2. 返回的告警按创建时间从新到旧排列"
LA-021,排序-按时间升序,获取最早的告警,"用户输入：查询业务7最早的告警
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""ordering"": [""create_time""]
}","1. ordering 使用 ""create_time""（无前缀表示升序）
2. 返回的告警按创建时间从旧到新排列"
LA-022,排序-按级别排序,按告警严重程度排序,"用户输入：查询业务7的告警，按严重程度排序
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""ordering"": [""severity""]
}","1. ordering 使用 ""severity""
2. 返回的告警按级别排序（1=致命, 2=预警, 3=提醒）"
LA-023,分页查询-第一页,获取第一页告警,"用户输入：查询业务7的告警，每页10条
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""page"": 1,
  ""page_size"": 10
}","1. page 设置为 1
2. page_size 设置为 10
3. 返回最多10条告警
4. 返回 total 字段显示总数"
LA-024,分页查询-翻页,获取第二页告警,"用户输入：查询业务7的告警，获取第2页，每页20条
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""page"": 2,
  ""page_size"": 20
}","1. page 设置为 2
2. page_size 设置为 20
3. 返回第21-40条告警"
LA-025,统计信息-概览统计,获取告警概览统计,"用户输入：查询业务7的告警统计信息
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""show_overview"": true
}","1. show_overview 设置为 true
2. 返回 overview 对象，包含各状态告警数量
3. 如：{""ABNORMAL"": 10, ""RECOVERED"": 5, ""CLOSED"": 2}"
LA-026,统计信息-聚合统计,获取告警趋势统计,"用户输入：查询业务7的告警趋势
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""show_aggs"": true
}","1. show_aggs 设置为 true
2. 返回聚合统计信息（趋势、分布）"
LA-027,复合查询-状态+时间+排序,多条件组合查询,"用户输入：查询业务7最近2小时未恢复的告警，按时间倒序
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""status"": [""ABNORMAL""],
  ""start_time"": 动态计算(当前时间-7200),
  ""end_time"": 动态计算(当前时间),
  ""ordering"": [""-create_time""]
}","1. 正确组合多个参数
2. 各条件同时生效
3. 返回符合所有条件的告警"
LA-028,复合查询-全条件组合,完整条件组合查询,"用户输入：查询业务7最近1小时内，状态为未恢复，级别为警告以上，负责人为admin的告警，按创建时间倒序，每页5条
预期调用：list_alerts
参数：{
  ""bk_biz_id"": ""7"",
  ""status"": [""ABNORMAL""],
  ""username"": ""admin"",
  ""conditions"": [
    {
      ""key"": ""severity"",
      ""value"": [""1"", ""2""],
      ""method"": ""eq""
    }
  ],
  ""start_time"": 动态计算(当前时间-3600),
  ""end_time"": 动态计算(当前时间),
  ""ordering"": [""-create_time""],
  ""page"": 1,
  ""page_size"": 5
}","1. 所有参数正确设置
2. 返回同时满足所有条件的告警
3. 结果按时间倒序，最多5条"
LA-029,参数转换验证,验证bk_biz_id到bk_biz_ids的转换,"用户输入：查询业务7的告警
预期调用：list_alerts
MCP层参数：{""bk_biz_id"": ""7""}
后台实际发送：{""bk_biz_ids"": [""7""]}","1. MCP层接收 bk_biz_id 参数
2. 自动转换为 bk_biz_ids 数组格式
3. 值保持一致：bk_biz_ids = [bk_biz_id]
4. 转换对用户透明"
LA-030,时间戳动态计算验证,验证时间戳必须动态计算,"用户输入：查询业务7最近的告警
预期行为：Agent应动态计算时间戳
Python: int(time.time())
JavaScript: Math.floor(Date.now()/1000)","1. 不使用固定的历史时间戳
2. end_time 为当前时间
3. start_time 为 end_time 减去时间间隔
4. 能查询到最新的告警数据"
GA-001,获取告警详情-基础查询,根据告警ID获取详细信息,"用户输入：查看业务7中告警ID为123456的详细信息
预期调用：get_alert_info
参数：{
  ""bk_biz_id"": ""7"",
  ""id"": ""123456""
}","1. 正确使用 get_alert_info 工具
2. bk_biz_id 和 id 参数正确传入
3. 返回完整的告警详情"
GA-002,获取告警详情-完整字段,验证返回的详情字段完整性,"用户输入：查看告警123456的完整信息
预期调用：get_alert_info","返回包含以下字段：
1. id - 告警ID
2. alert_name - 告警名称
3. status - 状态
4. severity - 级别
5. description - 详细描述
6. create_time - 创建时间
7. begin_time - 开始时间
8. latest_time - 最近触发时间
9. assignee - 负责人
10. extra_info - 额外信息（策略、原始告警等）
11. actions - 处理记录"
GA-003,获取告警详情-策略信息,查看告警关联的策略配置,"用户输入：查看告警123456的策略配置
预期调用：get_alert_info","1. 返回 extra_info.strategy 字段
2. 包含策略名称、监控目标、告警条件等"
GA-004,获取告警详情-处理记录,查看告警的处理历史,"用户输入：查看告警123456的处理记录
预期调用：get_alert_info","1. 返回 actions 数组
2. 包含确认/屏蔽操作记录
3. 包含处理人和处理时间"
GA-005,获取告警详情-收敛信息,查看告警的收敛情况,"用户输入：查看告警123456的收敛情况
预期调用：get_alert_info","1. 返回 alert_collect 字段
2. 包含收敛规则和被收敛的告警信息"
GA-006,获取告警详情-事件信息,查看告警的事件详情,"用户输入：查看告警123456的事件信息
预期调用：get_alert_info","1. 返回 event 字段
2. 包含触发告警的具体事件信息"
WF-001,完整工作流-列表到详情,先查列表再查详情的完整流程,"用户输入：查看业务7最近的告警，然后查看第一个告警的详细信息
预期流程：
1. 调用 list_alerts 获取告警列表
2. 从返回结果中提取第一个告警的 id
3. 调用 get_alert_info 获取详情","1. 正确遵循工作流顺序
2. 先调用 list_alerts
3. 从响应中正确提取 alert.id
4. 使用提取的 id 调用 get_alert_info
5. 整体流程流畅"
WF-002,故障排查工作流,使用告警进行故障排查,"用户输入：业务7的服务器好像有问题，帮我查查有什么告警
预期流程：
1. 查询该业务最近的告警
2. 优先关注未恢复、高级别告警
3. 获取关键告警详情
4. 给出排查建议","1. 主动查询 status: [""ABNORMAL""]
2. 优先展示 severity=1 的致命告警
3. 自动获取重要告警的详情
4. 提供有价值的分析和建议"
WF-003,告警趋势分析,分析告警趋势和模式,"用户输入：分析业务7最近一周的告警趋势
预期流程：
1. 查询最近7天的告警
2. 获取统计信息
3. 分析告警数量变化","1. 设置 show_overview: true, show_aggs: true
2. 时间范围设置为7天
3. 返回趋势统计数据
4. 提供趋势分析结论"
ERR-001,缺少必需参数-业务ID,未提供业务ID时的处理,"用户输入：查看最近的告警
预期行为：识别缺少 bk_biz_id","1. 识别缺少必需参数
2. 主动询问用户业务ID
3. 不使用默认值或猜测
4. 给出友好的提示信息"
ERR-002,无效的告警ID,使用不存在的告警ID,"用户输入：查看业务7中告警ID为999999999的详情
预期调用：get_alert_info
参数：{""bk_biz_id"": ""7"", ""id"": ""999999999""}","1. 调用工具并处理错误响应
2. 友好地告知用户告警不存在
3. 建议先使用 list_alerts 获取有效的告警ID"
ERR-003,时间范围过大,查询时间范围超出合理限制,"用户输入：查询业务7过去一年的所有告警
预期行为：提醒可能存在限制","1. 识别时间范围可能过大
2. 提醒用户可能存在数据量限制
3. 建议分批查询或缩小范围"
ERR-004,直接使用get_alert_info,未先获取告警ID就查详情,"用户输入：获取业务7的告警详情
预期行为：先获取告警ID","1. 识别需要先获取 alert_id
2. 主动调用 list_alerts
3. 询问用户要查看哪个告警
4. 或自动选择最新/最重要的告警"
ERR-005,空结果处理,查询条件下没有告警,"用户输入：查询业务100最近1小时的致命告警
预期行为：正确处理空结果","1. 正常执行查询
2. 正确处理空数组返回
3. 友好告知用户无符合条件的告警
4. 可建议调整查询条件或表示系统运行正常"
ERR-006,参数格式错误-status非数组,status参数格式错误,"错误示例：{""status"": ""ABNORMAL""}
正确格式：{""status"": [""ABNORMAL""]}","1. status 必须是数组格式
2. 即使只有一个值也要用数组
3. 错误格式应被正确处理或提示"
ERR-007,参数格式错误-ordering非数组,ordering参数格式错误,"错误示例：{""ordering"": ""-create_time""}
正确格式：{""ordering"": [""-create_time""]}","1. ordering 必须是数组格式
2. 错误格式应被正确处理"
ERR-008,conditions结构错误,conditions参数结构不完整,"错误示例：{""conditions"": [{""key"": ""alert_name""}]}
正确格式：必须包含 key 和 value","1. conditions 中每个对象必须有 key 和 value
2. 缺少必需字段应提示错误"
PERF-001,响应时间-少量数据,查询少量告警的响应时间,"查询条件：page_size=10
预期响应时间：< 3秒","1. 响应时间在可接受范围内
2. 用户体验良好"
PERF-002,响应时间-大量数据,查询大量告警的响应时间,"查询条件：page_size=100
预期响应时间：< 10秒","1. 大数据量查询可接受延迟
2. 返回结果完整"
DISP-001,结果可读性-告警列表,告警列表展示格式,"返回的告警列表展示","1. 告警列表格式清晰
2. 关键信息（名称、状态、级别）突出显示
3. 时间戳转换为可读格式
4. 告警级别有明确标识（1=致命, 2=预警, 3=提醒）"
DISP-002,结果可读性-告警详情,告警详情展示格式,"返回的告警详情展示","1. 详情信息结构化展示
2. 重要字段优先展示
3. 时间信息格式化
4. 处理记录按时间排序"
